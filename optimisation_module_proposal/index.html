
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.17">
    
    
      
        <title>Proposal for an Optimisation Module - NZ Tax Microsimulation Model</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.7e37652d.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config",""),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#proposal-for-an-optimisation-module" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="NZ Tax Microsimulation Model" class="md-header__button md-logo" aria-label="NZ Tax Microsimulation Model" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            NZ Tax Microsimulation Model
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Proposal for an Optimisation Module
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/edithatogo/nztaxmicrosim" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    edithatogo/nztaxmicrosim
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="NZ Tax Microsimulation Model" class="md-nav__button md-logo" aria-label="NZ Tax Microsimulation Model" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    NZ Tax Microsimulation Model
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/edithatogo/nztaxmicrosim" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    edithatogo/nztaxmicrosim
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    User Guide
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            User Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../CONTRIBUTING/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Contributing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../CITATION.cff" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Citing this work
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../CODE_OF_CONDUCT/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Code of Conduct
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../LICENSE" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    License
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Project Documentation
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Project Documentation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ROADMAP/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Roadmap
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../CHANGELOG/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Changelog
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../development_log/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Development Log
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SECURITY/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Security
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Model Documentation
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Model Documentation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../parameter_coverage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Parameter Coverage
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../inflation_adjustment/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Inflation Adjustment
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../demographic_modelling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Demographic Modelling
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../historical_reporting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Historical Reporting
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../modules/behavioural/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Behavioural Response
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data_dictionary/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Data Dictionary
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../feature_matrix/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Feature Matrix
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../policy_changes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Policy Changes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../modules/optimisation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Policy Optimisation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../historic_tax_search_plan/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Historic Tax Search Plan
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../nz_microsim_paper/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    NZ Microsim Paper
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../personal_tax_history/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Personal Tax History
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../personal_tax_history_1970-25_narrative/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Personal Tax History 1970-25 Narrative
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../personal_tax_history_1970-25_table/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Personal Tax History 1970-25 Table
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reporting_plan/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Reporting Plan
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../taxmicrosim_io/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tax Microsim I/O
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../taxmicrosim_report_components/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tax Microsim Report Components
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../validation_report/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Validation Report
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../wff_microsim_model_metadata/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    WFF Microsim Model Metadata
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../external/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    External
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../feature_comparison/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Feature Comparison
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../module_status/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Module Status
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../api_reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-problem-definition" class="md-nav__link">
    <span class="md-ellipsis">
      1. Problem Definition
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-proposed-approach" class="md-nav__link">
    <span class="md-ellipsis">
      2. Proposed Approach
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. Proposed Approach">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#high-level-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      High-Level Architecture
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-integration-with-the-microsimulation-model" class="md-nav__link">
    <span class="md-ellipsis">
      3. Integration with the Microsimulation Model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-challenges-and-considerations" class="md-nav__link">
    <span class="md-ellipsis">
      4. Challenges and Considerations
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-next-steps" class="md-nav__link">
    <span class="md-ellipsis">
      5. Next Steps
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-existing-work" class="md-nav__link">
    <span class="md-ellipsis">
      6. Existing Work
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-choice-of-tooling-specialized-vs-general-purpose" class="md-nav__link">
    <span class="md-ellipsis">
      7. Choice of Tooling: Specialized vs. General-Purpose
    </span>
  </a>
  
    <nav class="md-nav" aria-label="7. Choice of Tooling: Specialized vs. General-Purpose">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#analysis" class="md-nav__link">
    <span class="md-ellipsis">
      Analysis
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recommendation" class="md-nav__link">
    <span class="md-ellipsis">
      Recommendation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8-recommended-libraries" class="md-nav__link">
    <span class="md-ellipsis">
      8. Recommended Libraries
    </span>
  </a>
  
    <nav class="md-nav" aria-label="8. Recommended Libraries">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      Summary
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#9-staged-implementation-roadmap" class="md-nav__link">
    <span class="md-ellipsis">
      9. Staged Implementation Roadmap
    </span>
  </a>
  
    <nav class="md-nav" aria-label="9. Staged Implementation Roadmap">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#phase-1-simple-parameter-scanning-module-grid-search" class="md-nav__link">
    <span class="md-ellipsis">
      Phase 1: Simple Parameter Scanning Module (Grid Search)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-2-advanced-optimization-module-eg-optuna" class="md-nav__link">
    <span class="md-ellipsis">
      Phase 2: Advanced Optimization Module (e.g., Optuna)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="proposal-for-an-optimisation-module">Proposal for an Optimisation Module</h1>
<p>This document outlines a proposal for adding an optimisation module to the New Zealand tax microsimulation model. This exploration was prompted by the user's interest in finding optimal tax and transfer policies based on a set of defined objectives.</p>
<h2 id="1-problem-definition">1. Problem Definition</h2>
<p>The core idea is to create a module that can search for an "optimal" set of tax and transfer policy parameters. This requires defining:</p>
<ul>
<li>
<p><strong>An Objective Function:</strong> This is what we want to maximise or minimise. It could be a single objective or a combination of multiple objectives. Examples include:</p>
<ul>
<li>Maximising total tax revenue for the government.</li>
<li>Minimising income inequality (e.g., as measured by the Gini coefficient).</li>
<li>Maximising the average disposable income of households in the bottom quintile.</li>
<li>A weighted combination of the above.</li>
</ul>
</li>
<li>
<p><strong>Decision Variables:</strong> These are the policy parameters that the optimisation module can change. Examples include:</p>
<ul>
<li>Income tax bracket thresholds.</li>
<li>Income tax rates for each bracket.</li>
<li>The amount of a specific tax credit (e.g., the Independent Earner Tax Credit).</li>
<li>The abatement rate for a benefit.</li>
</ul>
</li>
<li>
<p><strong>Constraints:</strong> These are the rules that must be followed. Examples include:</p>
<ul>
<li>The total cost to the government cannot exceed a certain amount.</li>
<li>Tax rates cannot be negative or exceed 100%.</li>
<li>The order of tax brackets must be maintained.</li>
</ul>
</li>
</ul>
<p>The optimisation problem is then to find the set of decision variables that maximises (or minimises) the objective function, subject to the constraints.</p>
<h2 id="2-proposed-approach">2. Proposed Approach</h2>
<p>We can think of this as a "black box" optimisation problem. The microsimulation model is the black box: we give it a set of policy parameters, and it gives us a set of outcomes (like total tax revenue and a Gini coefficient). We want to find the best set of inputs to this black box.</p>
<p>Given the complexity of the microsimulation model, the relationship between the policy parameters and the outcomes is likely to be non-linear, with many local optima. This means that traditional gradient-based optimisation methods may not be suitable.</p>
<p>A more promising approach is to use <strong>metaheuristic optimisation algorithms</strong>, such as:</p>
<ul>
<li>
<p><strong>Genetic Algorithms (GAs):</strong> These algorithms are inspired by the process of natural selection. They work with a "population" of candidate solutions (sets of policy parameters). In each generation, the best solutions are selected and "bred" to create a new generation of solutions. This process is repeated until a good solution is found. GAs are well-suited to this kind of problem because they can explore a large and complex search space without getting stuck in local optima.</p>
</li>
<li>
<p><strong>Simulated Annealing (SA):</strong> This algorithm is inspired by the process of annealing in metallurgy. It starts with a random solution and then iteratively tries to improve it by making small random changes. It is more likely to accept changes that lead to a better solution, but it will sometimes accept changes that lead to a worse solution. This allows it to escape local optima.</p>
</li>
<li>
<p><strong>Particle Swarm Optimisation (PSO):</strong> This algorithm is inspired by the social behaviour of birds flocking or fish schooling. It works with a "swarm" of particles, where each particle represents a candidate solution. The particles move through the search space, and their movement is influenced by their own best-known position and the best-known position of the entire swarm.</p>
</li>
</ul>
<h3 id="high-level-architecture">High-Level Architecture</h3>
<p>The optimisation module would work as follows:</p>
<ol>
<li>
<p><strong>Initialisation:</strong> The user defines the objective function, the decision variables, and the constraints. The optimisation algorithm is initialised with a set of random candidate solutions.</p>
</li>
<li>
<p><strong>Evaluation:</strong> For each candidate solution (i.e., for each set of policy parameters), the optimisation module calls the microsimulation model to calculate the outcomes. The objective function is then evaluated for each candidate solution.</p>
</li>
<li>
<p><strong>Selection and Variation:</strong> The optimisation algorithm selects the best candidate solutions and uses them to generate a new set of candidate solutions.</p>
</li>
<li>
<p><strong>Termination:</strong> Steps 2 and 3 are repeated until a termination condition is met (e.g., a certain number of generations have been run, or the solution has not improved for a certain number of generations).</p>
</li>
<li>
<p><strong>Output:</strong> The best solution found is returned to the user.</p>
</li>
</ol>
<h2 id="3-integration-with-the-microsimulation-model">3. Integration with the Microsimulation Model</h2>
<p>The optimisation module would need to be able to:</p>
<ul>
<li><strong>Modify the policy parameters:</strong> This would likely involve creating a new set of parameter files for each candidate solution.</li>
<li><strong>Run the microsimulation model:</strong> The module would need to call the main function of the microsimulation model and pass it the path to the parameter files.</li>
<li><strong>Read the output of the microsimulation model:</strong> The module would need to read the output files of the microsimulation model to get the values of the outcomes needed to evaluate the objective function.</li>
</ul>
<h2 id="4-challenges-and-considerations">4. Challenges and Considerations</h2>
<ul>
<li>
<p><strong>Computational Cost:</strong> Microsimulation models can be computationally expensive to run. Since an optimisation algorithm may need to run the model thousands of times, the computational cost can be a major challenge. It may be necessary to use a simplified version of the model for the optimisation, or to use parallel computing to speed up the process.</p>
</li>
<li>
<p><strong>Defining "Equity":</strong> There are many different ways to measure equity (e.g., the Gini coefficient, the Palma ratio, the Theil index). The choice of equity measure will affect the results of the optimisation. It is important to choose a measure that is appropriate for the research question.</p>
</li>
<li>
<p><strong>Dynamic Microsimulation:</strong> The current model has a placeholder for dynamic simulation. If the model were to become fully dynamic (i.e., if it were to model the behavioural responses of individuals to policy changes), the optimisation problem would become much more complex. It would be necessary to consider the long-term effects of policy changes, and the optimisation algorithm would need to be able to handle this.</p>
</li>
<li>
<p><strong>Model Accuracy:</strong> The results of the optimisation are only as good as the underlying microsimulation model. It is important to ensure that the model is well-validated and that it accurately reflects the real world.</p>
</li>
</ul>
<h2 id="5-next-steps">5. Next Steps</h2>
<p>A good first step would be to develop a proof-of-concept implementation of an optimisation module. This could involve:</p>
<ol>
<li><strong>Choosing a simple objective function:</strong> For example, maximising total tax revenue.</li>
<li><strong>Choosing a small number of decision variables:</strong> For example, the tax rates for the existing income tax brackets.</li>
<li><strong>Implementing a simple optimisation algorithm:</strong> For example, a basic genetic algorithm.</li>
<li><strong>Integrating the optimisation module with the existing microsimulation model.</strong></li>
</ol>
<p>This proof-of-concept would allow us to explore the feasibility of the proposed approach and to identify any potential challenges. It would also provide a foundation for developing a more sophisticated optimisation module in the future.</p>
<h2 id="6-existing-work">6. Existing Work</h2>
<p>The idea of using optimisation with microsimulation models is not new. For example, the <strong>Policy Simulation Library (PSL)</strong> in the United States has a tool called <code>Tax-Brain</code> that allows users to explore the effects of different tax policies. While not a full optimisation tool, it provides a platform for "what-if" analysis that is a step in this direction.</p>
<p>There is also a body of academic literature on this topic. For example, a search for "tax policy optimisation using microsimulation" on Google Scholar will return a number of relevant papers. Reviewing this literature would be a valuable next step.</p>
<h2 id="7-choice-of-tooling-specialized-vs-general-purpose">7. Choice of Tooling: Specialized vs. General-Purpose</h2>
<p>A key implementation decision is whether to use a specialized library like the <strong>Policy Simulation Library (PSL)</strong> or a general-purpose optimization library like <strong>Optuna</strong>, <strong>Hyperopt</strong>, or <strong>Scikit-optimize</strong>.</p>
<p>For this project, the recommended approach is to use a <strong>general-purpose optimization library</strong>.</p>
<h3 id="analysis">Analysis</h3>
<p><strong>General-Purpose Optimizers (e.g., Optuna)</strong></p>
<p>This approach involves creating a Python wrapper function around the existing microsimulation model. This function would accept a set of policy parameters, run the simulation, and return a single "objective score" to be maximized or minimized.</p>
<ul>
<li>
<p><strong>Pros:</strong></p>
<ul>
<li><strong>High Flexibility:</strong> Integrates directly with the existing codebase without requiring a major rewrite.</li>
<li><strong>State-of-the-Art Algorithms:</strong> Provides access to powerful and efficient optimization algorithms (e.g., Bayesian optimization, TPE) well-suited for complex problems.</li>
<li><strong>Simplicity:</strong> The integration is conceptually straightforward and avoids the need to learn a new, large-scale framework.</li>
</ul>
</li>
<li>
<p><strong>Cons:</strong></p>
<ul>
<li>Requires writing some "boilerplate" code to connect the optimizer to the simulation (e.g., updating parameter files, parsing results).</li>
</ul>
</li>
</ul>
<p><strong>Specialized Libraries (e.g., PSL)</strong></p>
<ul>
<li>
<p><strong>Pros:</strong></p>
<ul>
<li><strong>Domain-Specific:</strong> Built specifically for policy simulation, potentially offering relevant tools and data structures.</li>
</ul>
</li>
<li>
<p><strong>Cons:</strong></p>
<ul>
<li><strong>High Adoption Cost:</strong> This is the critical drawback. PSL is heavily based on the US tax system. Adapting the existing New Zealand-specific model to fit PSL's framework would require a complete and costly re-engineering effort.</li>
<li><strong>Lack of Flexibility:</strong> The project would be constrained by the design decisions of the library, which may not be suitable for the nuances of the NZ system.</li>
</ul>
</li>
</ul>
<h3 id="recommendation">Recommendation</h3>
<p>Using a tool like <strong>Optuna</strong> is the clear winner. The cost of adapting the model to a specialized, US-centric library would be enormous and provide little benefit over a more flexible, general-purpose optimizer.</p>
<h2 id="8-recommended-libraries">8. Recommended Libraries</h2>
<p>Here is a comparison of recommended Python libraries for this task. The best choice depends on the specific needs of the optimization problem.</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Library</th>
<th style="text-align: left;">Key Strengths</th>
<th style="text-align: left;">Best For...</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">1. <strong>Optuna</strong></td>
<td style="text-align: left;"><strong>Overall Winner.</strong> Modern, very easy to use, powerful algorithms (TPE, CMA-ES), great visualization tools, and a large community.</td>
<td style="text-align: left;">Getting started quickly with a flexible and powerful tool that can handle a wide variety of optimization problems.</td>
</tr>
<tr>
<td style="text-align: left;">2. <strong>Scikit-optimize</strong></td>
<td style="text-align: left;">Specializes in <strong>Bayesian Optimization</strong>, which is highly efficient when each function call (i.e., each simulation run) is very slow and computationally expensive.</td>
<td style="text-align: left;">Problems where the simulation takes a long time to run, as it's designed to find a good solution in the fewest possible iterations.</td>
</tr>
<tr>
<td style="text-align: left;">3. <strong>SciPy (optimize)</strong></td>
<td style="text-align: left;"><strong>Robust and Standard.</strong> Part of the scientific Python stack, it includes powerful global optimization algorithms like <code>differential_evolution</code> that are very effective and require minimal configuration.</td>
<td style="text-align: left;">A solid, dependency-light solution. <code>differential_evolution</code> is a great general-purpose algorithm for global optimization.</td>
</tr>
</tbody>
</table>
<h3 id="summary">Summary</h3>
<ul>
<li><strong>Start with Optuna:</strong> Its intuitive API makes it very easy to set up an optimization "study".</li>
<li><strong>Consider <code>scikit-optimize</code> if runs are very slow:</strong> Its sample efficiency is a major advantage for computationally expensive simulations.</li>
<li><strong>Use <code>scipy.optimize</code> for a classic, robust approach:</strong> A great choice if you prefer to stick to the core scientific Python stack.</li>
</ul>
<h2 id="9-staged-implementation-roadmap">9. Staged Implementation Roadmap</h2>
<p>This pragmatic, two-phase approach allows for incremental development. We start by building the essential "plumbing" with a simple grid search, then swap in a powerful optimizer once the foundation is proven.</p>
<h3 id="phase-1-simple-parameter-scanning-module-grid-search">Phase 1: Simple Parameter Scanning Module (Grid Search)</h3>
<p>The goal is to create the basic infrastructure for running the simulation with varying parameters and collecting the results.</p>
<ol>
<li>
<p><strong>Create a Wrapper Function:</strong> Develop a core function (<code>run_simulation_with_params</code>) that:</p>
<ul>
<li>Accepts a dictionary of policy parameters.</li>
<li>Temporarily modifies the relevant JSON parameter files.</li>
<li>Calls the main microsimulation function.</li>
<li>Parses the output to retrieve key metrics (e.g., total tax revenue, Gini coefficient).</li>
<li>Returns these metrics.</li>
</ul>
</li>
<li>
<p><strong>Build the Grid Search Loop:</strong></p>
<ul>
<li>Create a script that defines a "grid" of parameters to test (e.g., a list of different tax rates).</li>
<li>Loop through every combination of these parameters.</li>
<li>For each combination, call the wrapper function and store the results.</li>
</ul>
</li>
<li>
<p><strong>Save Results:</strong> After the loop completes, save the collected results (input parameters and their corresponding output metrics) to a CSV file for easy analysis.</p>
</li>
</ol>
<h3 id="phase-2-advanced-optimization-module-eg-optuna">Phase 2: Advanced Optimization Module (e.g., Optuna)</h3>
<p>This phase builds directly on the work from Phase 1 by replacing the simple grid search with an intelligent optimizer.</p>
<ol>
<li>
<p><strong>Adapt the Wrapper:</strong> The <code>run_simulation_with_params</code> function from Phase 1 is adapted to become the <code>objective</code> function required by Optuna. It will be modified to return a single "score" to be optimized.</p>
</li>
<li>
<p><strong>Create an Optuna "Study":</strong></p>
<ul>
<li>Define a broad search space for the policy parameters (e.g., a tax rate can be any float between 0.10 and 0.25).</li>
<li>Create an Optuna study object.</li>
<li>Pass the <code>objective</code> function to Optuna's <code>optimize</code> method.</li>
</ul>
</li>
<li>
<p><strong>Leverage Intelligent Optimization:</strong> Optuna will intelligently call the objective function, efficiently searching the parameter space to find the optimal policy settings. This approach de-risks the project and ensures a working, useful tool is delivered at the end of Phase 1.</p>
</li>
</ol>









  




                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.92b07e13.min.js"></script>
      
    
  </body>
</html>